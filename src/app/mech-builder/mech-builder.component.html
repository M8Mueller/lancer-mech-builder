<div class="row">
  <div class="col-12 mt-3">
    <div class="d-flex mb-3">
      <!-- CORE -->
      <div class="mr-3">
        <div class="card card-fixed-lg">
          <h4 class="card-header">CORE</h4>
          <table class="table">
            <tr>
              <th>License Level</th>
              <td>
                <div class="btn-group btn-group-sm" role="group" aria-label="Pilot Level">
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': level === 0 || level === getTotalCore()}" (click)="removeLevel();">
                    <i class="fa fa-minus-circle"></i>
                  </button>
                  <button type="button" class="btn btn-secondary disabled">{{ level }}</button>
                  <button type="button" class="btn btn-secondary" [ngClass]="" (click)="addLevel();">
                    <i class="fa fa-plus-circle"></i>
                  </button>
                </div>
              </td>
            </tr>
            <ng-template #hullTooltip>
              <div>{{ core.hull || 0 }} CORE</div><div>{{ shell.hull || 0 }} SHELL</div>
            </ng-template>
            <tr>
              <th>Hull</th>
              <td>
                <div class="btn-group btn-group-sm" role="group" aria-label="CORE Hull">
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': core.hull === 0}" (click)="removeCore('hull');">
                    <i class="fa fa-minus-circle"></i>
                  </button>
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': core.hull === 0}" (click)="resetCore('hull')" placement="right" [ngbTooltip]="hullTooltip">{{ core.hull + (shell.hull || 0) }}</button>
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': getTotalCore() === level || core.hull === 6}" (click)="addCore('hull');">
                    <i class="fa fa-plus-circle"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr>
              <th>Agility</th>
              <td>
                <div class="btn-group btn-group-sm" role="group" aria-label="CORE Agility">
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': core.agility === 0}" (click)="removeCore('agility');">
                    <i class="fa fa-minus-circle"></i>
                  </button>
                  <button type="button" class="btn btn-secondary disabled">{{ core.agility }}</button>
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': getTotalCore() === level || core.agility === 6}" (click)="addCore('agility');">
                    <i class="fa fa-plus-circle"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr>
              <th>Systems</th>
              <td>
                <div class="btn-group btn-group-sm" role="group" aria-label="CORE Systems">
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': core.systems === 0}" (click)="removeCore('systems');">
                    <i class="fa fa-minus-circle"></i>
                  </button>
                  <button type="button" class="btn btn-secondary disabled">{{ core.systems }}</button>
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': this.getTotalCore() === level || core.systems === 6}" (click)="addCore('systems');">
                    <i class="fa fa-plus-circle"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr>
              <th>Engineering</th>
              <td>
                <div class="btn-group btn-group-sm" role="group" aria-label="CORE Systems">
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': core.engineering === 0}" (click)="removeCore('engineering');">
                    <i class="fa fa-minus-circle"></i>
                  </button>
                  <button type="button" class="btn btn-secondary disabled">{{ core.engineering }}</button>
                  <button type="button" class="btn btn-secondary" [ngClass]="{'disabled': this.getTotalCore() === level || core.engineering === 6}" (click)="addCore('engineering');">
                    <i class="fa fa-plus-circle"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="core.hp">
              <th>HP</th>
              <td>{{ core.hp }}</td>
            </tr>
            <tr *ngIf="core.targeting">
              <th>Targeting</th>
              <td>{{ core.targeting }}</td>
            </tr>
            <tr *ngIf="core.sp">
              <th>SP</th>
              <td>{{ core.sp }}</td>
            </tr>
            <tr *ngIf="core.mounts.length > 0">
              <th>Mounts</th>
              <td><div *ngFor="let mount of core.mounts">{{ mount.type }}</div></td>
            </tr>
          </table>
        </div>
      </div>
      <!-- SHELL -->
      <div class="mr-3">
        <div class="card card-fixed-lg">
          <button class="btn btn-secondary btn-sm card-header d-flex justify-content-between" (click)="browseShells()"><h4 class="mb-0">SHELL</h4><h5 class="mb-0 align-self-center">{{ shell.name }}</h5></button>
          <table class="table">
            <tr>
              <th>Size</th>
              <td>{{ shell.size }}</td>
            </tr>
            <tr *ngIf="shell.armor">
              <th>Armor</th>
              <td>{{ shell.armor }}</td>
            </tr>
            <tr *ngIf="shell.hull">
              <th>Hull</th>
              <td>
                {{ shell.hull }}
              </td>
            </tr>
            <tr *ngIf="shell.hp">
              <th>HP</th>
              <td>{{ shell.hp }}</td>
            </tr>
            <tr *ngIf="shell.critical">
              <th>Critical Gauge</th>
              <td>{{ shell.critical }}</td>
            </tr>
            <tr *ngIf="shell.agility">
              <th>Agility</th>
              <td>
                {{ shell.agility }}
              </td>
            </tr>
            <tr *ngIf="shell.speed">
              <th>Speed</th>
              <td>
                {{ shell.speed }}
              </td>
            </tr>
            <tr *ngIf="shell.systems">
              <th>Systems</th>
              <td>
                {{ shell.systems }}
              </td>
            </tr>
            <tr *ngIf="shell.engineering">
              <th>Engineering</th>
              <td>{{ shell.engineering }}</td>
            </tr>
            <tr *ngIf="shell.heatCap">
              <th>Heat Capacity</th>
              <td>{{ shell.heatCap }}</td>
            </tr>
            <tr *ngIf="shell.targeting">
              <th>Targeting</th>
              <td>{{ shell.targeting }}</td>
            </tr>
            <tr>
              <th>SP</th>
              <td>{{ shell.sp }}</td>
            </tr>
            <tr>
              <th>Mounts</th>
              <td><div *ngFor="let mount of shell.mounts">{{ mount.type }}</div></td>
            </tr>
          </table>
        </div>
      </div>
      <!-- WEAPONS -->
      <div class="mr-3 mb-5">
        <div class="card card-fixed-lg">
          <h4 class="card-header">WEAPONS</h4>
          <div class="card-body">
            <div *ngFor="let mount of shell.mounts; let i = index;">
              <h5>{{ mount.type }}</h5>
              <div class="d-flex justify-content-between">
                <button class="btn btn-secondary" (click)="browseWeapons(mount, i)">Equip</button>
                <button class="btn btn-secondary" [ngClass]="{'disabled': mount.weapon?.mount !== 'Aux'}" *ngIf="mount.type === 'Flex' || mount.type === 'Aux'" (click)="browseWeapons(mount, i, true)">Equip</button>
              </div>
              <div class="d-flex justify-content-between">
                <div>{{ mount.weapon?.name || 'Empty'}}</div>
                <div *ngIf="mount.type === 'Aux' || mount.type === 'Flex' || mount.type === 'Core'">{{ mount.auxWeapon?.name || 'Empty'}}</div>
              </div>
            </div>

            <div *ngFor="let mount of core.mounts; let i = index;">
              <h5>{{ mount.type }}</h5>
              <div class="d-flex justify-content-between">
                <button class="btn btn-secondary" (click)="browseWeapons(mount, i)">Equip</button>
                <button class="btn btn-secondary" [ngClass]="{'disabled': mount.weapon?.mount !== 'Aux'}" (click)="browseWeapons(mount, i, true)">Equip</button>
              </div>
              <div class="d-flex justify-content-between">
                <div>{{ mount.weapon?.name || 'Empty'}}</div>
                <div *ngIf="mount.type === 'Aux' || mount.type === 'Flex' || mount.type === 'Core'">{{ mount.auxWeapon?.name || 'Empty'}}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- <div class="d-flex flex-column mr-3">
        <h4 class="h4">Weapons</h4>
        <div class="card mb-3" style="width: 12rem;" *ngFor="let mount of shell.mounts; let i = index;">
          <h5 class="card-header">{{ mount.type }}</h5>
          <div class="card-body d-flex justify-content-between">
            <button class="btn btn-secondary" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
            <button class="btn btn-secondary" [ngClass]="{'disabled': mount.weapon?.mount !== 'Aux'}" *ngIf="mount.type === 'Flex' || mount.type === 'Aux'" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
          </div>
        </div>

        <div class="card mb-3" style="width: 12rem;" *ngFor="let mount of core.mounts; let i = index;">
          <h5 class="card-header">{{ mount.type }}</h5>
          <div class="card-body d-flex justify-content-between">
            <button class="btn btn-secondary" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
            <button class="btn btn-secondary" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
          </div>
        </div>
      </div>

      <div class="d-flex flex-column">
        <div class="d-flex justify-content-between">
          <h4 class="h4">Systems</h4><h5 class="h5">SP: {{ shell.sp + core.sp }}</h5>
        </div>
        <div class="card mb-3" style="width: 12rem;" *ngFor="let mount of shell.mounts; let i = index;">
          <h5 class="card-header">{{ mount.type }}</h5>
          <div class="card-body d-flex justify-content-between">
            <button class="btn btn-secondary" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
            <button class="btn btn-secondary" [ngClass]="{'disabled': mount.weapon?.mount !== 'Aux'}" *ngIf="mount.type === 'Flex' || mount.type === 'Aux'" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
          </div>
        </div>

        <div class="card mb-3" style="width: 12rem;" *ngFor="let mount of core.mounts; let i = index;">
          <h5 class="card-header">{{ mount.type }}</h5>
          <div class="card-body d-flex justify-content-between">
            <button class="btn btn-secondary" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
            <button class="btn btn-secondary" (click)="browseWeapons(mount, i)" style="width: 4rem; height: 4rem;">Equip</button>
          </div>
        </div>
      </div> -->
    </div>

    <div class="mb-5" *ngIf="showShells">
      <button class="btn btn-secondary mr-2" *ngFor="let shell of availableShells" (click)="setShell(shell);">
        {{ shell.corp }} {{ shell.name }}
      </button>
    </div>

    <div class="mb-5" *ngIf="showWeapons">
      <button class="btn btn-secondary mr-2" (click)="mountWeapon(null, activeMount);">
        Empty
      </button>
      <button class="btn btn-secondary mr-2" *ngFor="let weapon of availableWeapons" [ngClass]="{'disabled': !canMount(weapon, activeMount)}" (click)="mountWeapon(weapon, activeMount);">
        {{ weapon.corp }} {{ weapon.name }} 
      </button>
    </div>

  </div>
</div>